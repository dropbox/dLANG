sil_stage canonical

import Builtin
import Swift
import SwiftShims

func incrementingWhile(_ n: Int) -> Int

// main
// Isolation: unspecified
sil @main : $@convention(c) (Int32, UnsafeMutablePointer<Optional<UnsafeMutablePointer<Int8>>>) -> Int32 {
[%1: noescape **]
[global: ]
bb0(%0 : $Int32, %1 : $UnsafeMutablePointer<Optional<UnsafeMutablePointer<Int8>>>):
  %2 = integer_literal $Builtin.Int32, 0          // user: %3
  %3 = struct $Int32 (%2)                         // user: %4
  return %3                                       // id: %4
} // end sil function 'main'

// incrementingWhile(_:)
// Isolation: unspecified
sil hidden @$s11simple_loop17incrementingWhileyS2iF : $@convention(thin) (Int) -> Int {
[global: ]
// %0 "n"                                         // users: %4, %1
bb0(%0 : $Int):
  debug_value %0, let, name "n", argno 1          // id: %1
  %2 = integer_literal $Builtin.Int64, 0          // users: %7, %10, %5, %3
  debug_value %2, var, name "i", type $Int, expr op_fragment:#Int._value // id: %3
  %4 = struct_extract %0, #Int._value             // users: %5, %17
  %5 = builtin "cmp_slt_Int64"(%2, %4) : $Builtin.Int1 // user: %6
  cond_br %5, bb2, bb1                            // id: %6

bb1:                                              // Preds: bb0
  br bb6(%2)                                      // id: %7

bb2:                                              // Preds: bb0
  %8 = integer_literal $Builtin.Int64, 1          // user: %12
  %9 = integer_literal $Builtin.Int1, -1          // user: %12
  br bb3(%2)                                      // id: %10

// %11                                            // user: %12
bb3(%11 : $Builtin.Int64):                        // Preds: bb5 bb2
  %12 = builtin "sadd_with_overflow_Int64"(%11, %8, %9) : $(Builtin.Int64, Builtin.Int1) // users: %14, %13
  %13 = tuple_extract %12, 0                      // users: %19, %20, %17, %16
  %14 = tuple_extract %12, 1                      // user: %15
  cond_fail %14, "arithmetic overflow"            // id: %15
  debug_value %13, var, name "i", type $Int, expr op_fragment:#Int._value // id: %16
  %17 = builtin "cmp_slt_Int64"(%13, %4) : $Builtin.Int1 // user: %18
  cond_br %17, bb5, bb4                           // id: %18

bb4:                                              // Preds: bb3
  br bb6(%13)                                     // id: %19

bb5:                                              // Preds: bb3
  br bb3(%13)                                     // id: %20

// %21                                            // user: %22
bb6(%21 : $Builtin.Int64):                        // Preds: bb4 bb1
  %22 = struct $Int (%21)                         // user: %23
  return %22                                      // id: %23
} // end sil function '$s11simple_loop17incrementingWhileyS2iF'



// Mappings from '#fileID' to '#filePath':
//   'simple_loop/simple_loop.swift' => '/Users/ayates/tSwift/tests/verification/simple_loop.swift'


