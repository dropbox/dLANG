// SIL test file: Int32 Subtraction with overflow check
// Tests that bitwidth-specific bounds (-2147483648 to 2147483647) are used for subtraction

sil_stage canonical

import Builtin
import Swift

// Int32 sub function with overflow check
// Subtraction can overflow when:
// - a - b < -2147483648 (e.g., -2147483648 - 1 = underflow)
// - a - b > 2147483647 (e.g., 0 - (-2147483648) = overflow)
sil hidden @sub_int32 : $@convention(thin) (Int32, Int32) -> Int32 {
bb0(%0 : $Int32, %1 : $Int32):
  debug_value %0, let, name "a", argno 1
  debug_value %1, let, name "b", argno 2
  %4 = struct_extract %0, #Int32._value
  %5 = struct_extract %1, #Int32._value
  %6 = integer_literal $Builtin.Int1, -1
  %7 = builtin "ssub_with_overflow_Int32"(%4, %5, %6) : $(Builtin.Int32, Builtin.Int1)
  %8 = tuple_extract %7, 0
  %9 = tuple_extract %7, 1
  cond_fail %9, "arithmetic overflow"
  %11 = struct $Int32 (%8)
  return %11
}
