sil_stage canonical

import Builtin
import Swift
import SwiftShims

// Minimal SIL capturing modulo-by-zero detection:
// - srem_Int64 builtin for signed modulo (remainder)
// - No precondition on divisor, so verification should FAIL
//
// This file is used by integration tests for `tswift-verify --sil`.
// Simulated source: func modulo(_ a: Int, _ b: Int) -> Int { return a % b }
sil hidden @modulo : $@convention(thin) (Int, Int) -> Int {
bb0(%0 : $Int, %1 : $Int):
  debug_value %0, let, name "a", argno 1, loc "math.swift":5:15, scope 2
  debug_value %1, let, name "b", argno 2, loc "math.swift":5:25, scope 2
  %2 = struct_extract %0, #Int._value, loc "math.swift":5:45, scope 2
  %3 = struct_extract %1, #Int._value, loc "math.swift":5:49, scope 2
  %4 = builtin "srem_Int64"(%2, %3) : $Builtin.Int64, loc "math.swift":5:45, scope 2
  %5 = struct $Int (%4), loc "math.swift":5:45, scope 2
  return %5, loc "math.swift":5:37, scope 2
}
