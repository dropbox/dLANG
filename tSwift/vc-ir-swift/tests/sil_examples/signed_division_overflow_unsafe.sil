sil_stage canonical

import Builtin
import Swift
import SwiftShims

// Minimal SIL capturing signed division overflow detection:
// - sdiv_Int64 builtin for signed division
// - No constraints on inputs, so INT_MIN / -1 overflow is possible
// - Verification should detect BOTH division-by-zero AND overflow
//
// This file is used by integration tests for `tswift-verify --sil`.
// Simulated source: func divideUnchecked(_ a: Int, _ b: Int) -> Int { return a / b }
//
// Division overflow: INT_MIN (e.g., -9223372036854775808) / -1 = INT_MAX + 1 (overflows)
sil hidden @divideUnchecked : $@convention(thin) (Int, Int) -> Int {
bb0(%0 : $Int, %1 : $Int):
  debug_value %0, let, name "a", argno 1, loc "math.swift":5:20, scope 1
  debug_value %1, let, name "b", argno 2, loc "math.swift":5:30, scope 1
  %2 = struct_extract %0, #Int._value, loc "math.swift":5:52, scope 1
  %3 = struct_extract %1, #Int._value, loc "math.swift":5:56, scope 1
  %4 = builtin "sdiv_Int64"(%2, %3) : $Builtin.Int64, loc "math.swift":5:52, scope 1
  %5 = struct $Int (%4), loc "math.swift":5:52, scope 1
  return %5, loc "math.swift":5:44, scope 1
}
