// SIL test file: Int32 negation as subtraction with overflow check
// Swift implements -x as 0 - x using ssub_with_overflow
// This can overflow when x = Int32.min (because -Int32.min > Int32.max)
//
// Bounds: -2147483648 to 2147483647

sil_stage canonical

import Builtin
import Swift

// Negation function: returns -x
// Overflow: -(-2147483648) = 2147483648, which exceeds Int32.max (2147483647)
sil hidden @neg_int32 : $@convention(thin) (Int32) -> Int32 {
bb0(%0 : $Int32):
  debug_value %0, let, name "x", argno 1
  %2 = struct_extract %0, #Int32._value
  %3 = integer_literal $Builtin.Int32, 0
  %4 = integer_literal $Builtin.Int1, -1
  %5 = builtin "ssub_with_overflow_Int32"(%3, %2, %4) : $(Builtin.Int32, Builtin.Int1)
  %6 = tuple_extract %5, 0
  %7 = tuple_extract %5, 1
  cond_fail %7, "arithmetic overflow"
  %9 = struct $Int32 (%6)
  return %9
}

