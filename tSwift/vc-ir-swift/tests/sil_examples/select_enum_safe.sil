sil_stage canonical

import Builtin
import Swift
import SwiftShims

// isNone: returns true if Optional is .none, false otherwise
// This uses select_enum to pick a boolean value based on the enum case
// The postcondition is trivially true since we only return true or false
@_ensures("result == true || result == false")
func isNone(_ value: Optional<Int>) -> Bool

// Implementation using select_enum
sil hidden @$s11select_enum6isNoneyS2bSiSgF : $@convention(thin) (Optional<Int>) -> Bool {
bb0(%0 : $Optional<Int>):
  debug_value %0, let, name "value", argno 1
  // Create the true and false values
  %1 = integer_literal $Builtin.Int1, -1  // true
  %2 = integer_literal $Builtin.Int1, 0   // false
  %3 = struct $Bool (%1)  // true Bool
  %4 = struct $Bool (%2)  // false Bool
  // select_enum: pick %3 (true) for .none, %4 (false) for .some
  %5 = select_enum %0 : $Optional<Int>, case #Optional.none!enumelt: %3, case #Optional.some!enumelt: %4 : $Bool
  return %5
} // end sil function '$s11select_enum6isNoneyS2bSiSgF'
